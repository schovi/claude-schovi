# Specification Template Reference

This document defines the structure for implementation specifications generated by `/schovi:create-spec`.

## Template Types

### Full Template
Used when detailed analysis is available. Includes comprehensive technical details, decision rationale, and implementation guidance.

**When to use**: After `/schovi:analyze-problem`, from Jira with analysis, from detailed analysis file

### Minimal Template
Used for simple tasks or when creating specs from scratch. Focuses on essential information only.

**When to use**: `--from-scratch` mode, simple bug fixes, straightforward tasks without analysis

---

## Full Template Structure

```markdown
---
jira_id: EC-1234
title: "Brief description of the change"
status: "DRAFT"
approach_selected: "Option 2: Backend service + queue"
created_date: 2025-04-11
created_by: user@example.com
---

# SPEC: EC-1234 Brief Description

## Decision & Rationale

**Approach Selected**: Option 2 - Backend service with Kafka queue

**Rationale**: [2-3 sentences explaining WHY this approach was chosen over others. Focus on alignment with architecture, scalability, maintainability, or other key factors.]

**Alternatives Considered**:
- Option 1: [Solution name] (rejected: [reason in 1 sentence])
- Option 3: [Solution name] (rejected: [reason in 1 sentence])

## Technical Overview

### Data Flow
[Diagram or description showing how data moves through the system]

```
Input Source: [Where data originates]
  ↓
Validation: [file:line reference]
  ↓
Transformation: [file:line reference]
  ↓
Business Logic: [file:line reference]
  ↓
Persistence: [Database/storage]
  ↓
Output: [Where data goes]
```

### Affected Services
- **ServiceName** (`path/to/service.ts:123`): [Role and what changes]
- **AnotherService** (`path/to/another.ts:456`): [Role and what changes]

### Key Changes
- [Major change 1 - high level]
- [Major change 2 - high level]
- [Major change 3 - high level]

## Implementation Tasks

### Phase 1: [Phase Name - e.g., Backend Service]
- [ ] [Specific, actionable task] (`file:line` if applicable)
- [ ] [Another specific task] (`file:line` if applicable)
- [ ] [Another task]

### Phase 2: [Phase Name - e.g., Frontend Integration]
- [ ] [Specific task]
- [ ] [Another task]

### Phase 3: [Phase Name - e.g., Testing & Validation]
- [ ] [Testing-related task]
- [ ] [Validation task]

## Acceptance Criteria

- [ ] [Testable criterion 1 - specific and measurable]
- [ ] [Testable criterion 2 - specific and measurable]
- [ ] [Testable criterion 3 - specific and measurable]
- [ ] All tests pass (unit + integration)
- [ ] Code passes linting
- [ ] Code reviewed and approved

## Testing Strategy

### Unit Tests
- **Test file**: `path/to/component.spec.ts`
  - Scenario 1: [What to test]
  - Scenario 2: [What to test]
  - Scenario 3: [What to test]

- **Test file**: `path/to/service.spec.ts`
  - Scenario 1: [What to test]
  - Scenario 2: [What to test]

### Integration Tests
- **Scenario**: [End-to-end integration scenario]
  - Setup: [Prerequisites]
  - Execute: [What to run]
  - Assert: [Expected outcome]

- **Scenario**: [Another integration scenario]
  - Setup: [Prerequisites]
  - Execute: [What to run]
  - Assert: [Expected outcome]

### Manual Testing
- [ ] [User flow 1 to verify manually]
- [ ] [User flow 2 to verify manually]
- [ ] [Edge case 1 to test]
- [ ] [Edge case 2 to test]

## Risks & Mitigations

- **Risk**: [Description of potential risk]
  - *Mitigation*: [How to reduce or handle this risk]

- **Risk**: [Another potential risk]
  - *Mitigation*: [Mitigation strategy]

- **Risk**: [Third risk if applicable]
  - *Mitigation*: [Mitigation strategy]

## References

- Jira issue: [JIRA-ID or link]
- Analysis: [Link to analysis artifact or Jira comment]
- Architecture docs: [Link if applicable]
- Related PRs: [Links if applicable]
```

---

## Minimal Template Structure

```markdown
---
title: "Brief description of the task"
status: "DRAFT"
created_date: 2025-04-11
---

# SPEC: Brief Description

## Goal

[2-3 sentences describing what needs to be built or fixed and why it matters]

## Requirements

- [Requirement 1]
- [Requirement 2]
- [Requirement 3]
- [Requirement 4]
- [Requirement 5]

## Implementation Tasks

- [ ] [Task 1 - specific and actionable]
- [ ] [Task 2 - specific and actionable]
- [ ] [Task 3 - specific and actionable]
- [ ] [Task 4 - specific and actionable]
- [ ] [Task 5 - specific and actionable]

## Acceptance Criteria

- [ ] [Testable criterion 1]
- [ ] [Testable criterion 2]
- [ ] [Testable criterion 3]
- [ ] Tests pass
- [ ] Code reviewed

## Testing

**Manual test**:
1. [Step 1 to verify functionality]
2. [Step 2]
3. [Step 3]

**Expected result**: [What should happen when working correctly]
```

---

## Field Descriptions

### YAML Frontmatter

- **jira_id** (optional): Jira issue key (EC-1234, IS-8046, etc.)
- **title** (required): Brief description of the change (50-80 chars)
- **status** (required): Always "DRAFT" when created
- **approach_selected** (full template): Which solution option was chosen
- **created_date** (required): Date spec was generated (YYYY-MM-DD)
- **created_by** (optional): Email of spec creator if available

### Sections

#### Decision & Rationale (Full Template)
**Purpose**: Document WHY this approach was chosen to guide future decisions and prevent second-guessing

**Approach Selected**: Name of the chosen solution
**Rationale**: 2-3 sentences explaining the reasoning (alignment, benefits, trade-offs)
**Alternatives Considered**: Other options that were rejected and brief reason each

#### Goal (Minimal Template)
**Purpose**: State what needs to be accomplished in clear, simple terms

2-3 sentences covering:
- What is being built/fixed
- Why it matters
- Expected outcome

#### Technical Overview (Full Template)
**Purpose**: Provide high-level technical context for implementation

**Data Flow**: Visual or textual representation of data movement
**Affected Services**: List of services/components being modified with file references
**Key Changes**: 3-5 major modifications at a high level

#### Requirements (Minimal Template)
**Purpose**: List what the solution must include

Simple bullet list of functional requirements, no technical implementation details

#### Implementation Tasks
**Purpose**: Break down work into actionable, trackable tasks

- Use checkboxes (`- [ ]`) for all tasks
- Group into phases if complex (full template)
- Each task should be specific and implementable
- Include file:line references where applicable
- Each task should be ~30-60 minutes of work

#### Acceptance Criteria
**Purpose**: Define DONE - what must be true for this to be complete

- Use checkboxes (`- [ ]`) for all criteria
- Each criterion must be testable/verifiable
- Be specific (avoid "works well" - use "responds in <200ms")
- Always include quality criteria (tests, linting, review)

#### Testing Strategy (Full Template)
**Purpose**: Define how to verify correctness at all levels

**Unit Tests**: Which test files need updates, what scenarios to cover
**Integration Tests**: End-to-end scenarios with setup/execute/assert
**Manual Testing**: User-facing verification steps as checklist

#### Testing (Minimal Template)
**Purpose**: Brief guidance on how to verify it works

Simple manual test steps with expected result

#### Risks & Mitigations (Full Template)
**Purpose**: Document known risks and how to handle them

- List potential problems (technical, business, operational)
- Provide mitigation strategy for each
- Consider: performance, backward compatibility, rollout, dependencies

#### References (Full Template)
**Purpose**: Link to related resources for context

- Jira issue link
- Analysis artifacts
- Architecture documentation
- Related PRs or issues

---

## Writing Guidelines

### Be Specific
❌ "Fix the bug in the validator"
✅ "Update validation logic in `FieldMappingValidator.ts:67` to reject boolean field types"

### Be Actionable
❌ "Improve error handling"
✅ "Add try-catch block in `processRequest()` method to catch ValidationError and return 400 status"

### Be Measurable
❌ "System should be fast"
✅ "API response time <200ms for 95th percentile"

### Use File References
❌ "Update the controller"
✅ "Update `api/controllers/MappingController.ts:123`"

### Make Tasks Atomic
❌ "Implement the feature"
✅ Multiple specific tasks:
- "Create `FeatureService` class"
- "Add `processFeature()` method"
- "Wire up dependency injection"

---

## Status Values

- **DRAFT**: Spec is newly created, needs review
- **APPROVED**: Spec reviewed and ready for implementation
- **IN_PROGRESS**: Implementation has started
- **COMPLETED**: Implementation finished
- **DEPRECATED**: Spec is no longer relevant

---

## Examples

See the spec-generator subagent AGENT.md file for complete examples of both full and minimal specs.

---

## Usage

This template is referenced by:
- `/schovi:create-spec` command
- `spec-generator` subagent

When generating specs, the subagent reads this structure and fills in sections based on available analysis content.
